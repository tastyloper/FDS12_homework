# 13. Angular Pipe

## 1. 파이프(Pipe)란?
* 애플리케이션이 관리하는 데이터는 사용자가 실생활에서 익숙한 형태의 데이터가 아닌 경우가 많다. 
* 데이터 자체를 변경하는 것은 부수 효과(side effect)가 있으므로 화면에 표시하는 형식만 변경하고 싶을 때 사용하는 것이 파이프(pipe)이다.
* 파이프의 대상 값 뒤에 파이프 연산자 `|`를 붙인 후 원하는 파이프를 지정한다. `:`로 구분하여 파이프 옵션을 지정할 수 있고, 파이프 연산자 `|`를 연이어 체이닝 방식으로 파이프를 추가할 수도 있다.

## 2. 빌트인 파이프
* Angular는 아래와 같은 빌트인 파이프를 지원한다.

| 파이프 | 의미 |
| :---- | :------------ |
| date  | 날짜 형식 변환   |
| json   | JSON 형식 변환   |
| uppercase | 대문자 변환      |
| lowercase | 소문자 변환      |
| currency  | 통화 형식 변환   |
| percent   | 퍼센트 형식 변환 |
| decimal   | 자리수 형식 변환 |
| slice     | 문자열 추출      |
| async      | 비동기 객체 출력 |

## 3. 체이닝 파이프
* 여러 개의 파이프를 조합하여 결과를 출력하는 것을 체이닝 파이프라 한다.
* 체이닝 방식으로 파이프 연산자 `|`에 연이어 파이프를 추가하면 파이프의 조합으로 결과를 출력한다.

## 4. 커스텀 파이프
* 파이프는 @Pipe 데코레이터로 장식된 클래스이다.
* @Pipe 메타데이터 객체의 name 프로퍼티에 파이프의 식별자를 지정한다.
* 파이프 클래스는 PipeTransform 인터페이스의 추상 메소드 transform을 구현해야 한다.
* `transform(value: any, ...args: any[]): any`
* transform 메소드는 파이프의 변환 대상인 값(value)과 옵션(args)들을 인자로 받고 변환된 값을 반환한다.
* 옵션은 Rest 파라미터로 정의되어 있어서 여러 개의 옵션을 파라미터로 전달할 수 있다.
* 커스텀 파이프는 모듈의 declarations에 등록되어야 한다.
* 커스텀 파이프는 빌트인 파이프와 동일한 방법으로 탬플릿에서 사용한다.

## 5. 파이프와 변화 감지(Change detection)
* 변화 감지(Change detection)란 뷰와 모델의 동기화를 유지하기 위해 상태 변화를 감지하고 이를 반영하는 것을 말한다. 즉, 상태의 변화를 감지하여 뷰에 반영하는 것으로 데이터 바인딩은 변화 감지 매커니즘의 토대 위에서 수행된다.
*  Angular는 DOM 이벤트(click, key press, mouse move 등), Timer(setTimeout, setInterval)의 tick 이벤트, 서버와의 Ajax 통신 이후 변화 감지를 통해 데이터 바인딩 대상의 변경 사항을 찾는다. 이것은 시스템에 부하를 증가시키는 작업이다. Angular는 가능한 부하를 최소한으로 하기 위해 파이프를 사용할 때는 보다 간단하고 빠른 변경 감지 알고리즘을 사용한다.
*  간단한 애플리케이션은 프로퍼티의 변경 시점을 간단히 파악할 수 있지만 복잡한 애플리케이션이라면 프로퍼티가 어디서 변경되는지 파악하기 힘들 수도 있다. 또한 파이프를 위해 코드를 수정하는 것은 피하고 싶을 수도 있다. 이를 위해 Angular는 비순수 파이프(impure pipe)를 제공한다.

## 6. 순수 파이프(pure pipe)와 비순수 파이프(impure pipe)
* 파이프는 순수 파이프(pure pipe)와 비순수 파이프(impure pipe)로 분류할 수 있다.
* 비순수 파이프는 @Pipe 메타데이터 객체의 pure 프로퍼티에 false를 지정한 것이다. pure 프로퍼티를 생략하면 순수 파이프로 동작한다.
* 비순수 파이프를 사용하면 빈번하게 파이프가 호출되어 퍼포먼스 측면에서 좋지 않으므로 주의하여야 한다.
* 순수 파이프는 원시 타입의 값 또는 객체 참조의 변경과 같은 순수한 변경(pure change)만을 감지하고 파이프를 실행한다.
* Angular는 퍼포먼스를 위해 객체 내부의 변경은 무시하여 순수 파이프를 실행하지 않는다. 따라서 퍼포먼스를 생각한다면 비순수 파이프보다 순수 파이프를 사용하는 것이 바람직하다. 또한 불가피한 상황이 아니라면 파이프보다는 컴포넌트 프로퍼티의 값을 변경하여 사용하는 편이 유리하다.